<!DOCTYPE html>
<html dir="ltr" lang="es">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0,viewport-fit=cover" />

<style>
  body {
    background-color: #060d21;
    color: green;
    font-family: monospace;
    margin: 30px;
  }

  .node {
    /* width: 320px; */
    width: auto;
    /* height: 200px; */
    border: green;
    border-style: solid;
    border-radius: 5px 5px 5px 5px;
    display: inline-block;
    margin-top: 5px;
    margin-right: 5px;
  }

  /* .nodeContent {
    margin: 10px;
    float: inherit;
  } */

  .text {
    margin-left: 10px;
    margin-right: 10px;
    margin-top: 7px;
    margin-bottom: 7px;
  }

</style>

<body>
  <div id="main">
    <h1 id="title">Connecting...</h1>
  </div>
  <div id="boxes">
  </div>

  <div id="boxTemplate1" style="display: none;">
    <div class="nodeContent leftLabel">
      <div id="id-text" class="text">us-east-1</br>14ms</div>
    </div>
  </div>


</body>

<script>
  const module = {}
  let wrtc
</script>
<script src="simplepeer.min.js"></script>
<script src="peerNode/peer.js"></script>
<script>
  const template1 = document.getElementById("boxTemplate1")


  function newPeer(peerId) {
    console.log("NEW PEER HTML", peerId)
    let data = { name: peerId, latency: "?" }
    let elem1 = document.createElement('div')
    elem1.classList = ['node']
    elem1.id = peerId

    let elem2 = document.createElement('div')
    elem2.classList = ['nodeContent', 'leftLabel']

    let elem3 = document.createElement('div')
    elem3.classList = ['text']

    elem2.append(elem3)
    elem1.append(elem2)

    document.getElementById("boxes").appendChild(elem1)

    let tools = {
      setLatency: (ms) => {
        data.latency = ms
      },
      render: () => {
        elem3.innerHTML = [data.name, `${data.latency} ms.`].join("</br>") //"us-east-1</br>13ms"
        setTimeout(() => {
          elem3.innerHTML = [data.name, `${data.latency} ms`].join("</br>") //"us-east-1</br>13ms"
        }, 100)
      },
      remove: () => {
        elem1.style = "display: none;"
      }
    }

    tools.render()

    return tools
  }

  peerNode(SimplePeer,
    WebSocket,
    wrtc,
    {
      newPeer
    })

  for (let i = 0; i < 10; i++) {
    newPeer(i)
  }

</script>

</html>
